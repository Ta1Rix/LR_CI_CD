name: CI/CD Pipeline for Car Project

on:
  pull_request:
    branches: [ main, master ]
  push:
    branches: [ main, master ]
  workflow_dispatch: 

jobs:
  quality-checks:
    name: Code Quality & Tests
    runs-on: ubuntu-latest
    
    steps:
   
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install ruff pytest
        
    - name: Check Python imports
      run: |
        python -c "import sys; sys.path.insert(0, 'src'); from car import Car; print('Car class imported successfully')"
        
    - name: Run Unit Tests
      run: |
        echo "Running tests from src/test_class_car.py"
        cd src
        pytest test_class_car.py -v
        
    - name: Run Ruff linter
      run: |
        echo "Checking all Python files in src/"
        ruff check --config=ruff.toml ./src/
        
    
    - name: Lint source files only (excluding tests)
      run: |
        echo "Linting source files (excluding test files)"
        ruff check --config=ruff.toml --exclude "*test*.py" ./src/
